<!--Project ecosystem 1 by Daria Evseeva, Eduardo Vela, Nicolas Brich, Sarah Ertel, Constantin Holzapfel 21.1.19 -->

{% extends "base.html" %}
{% block content %}

<script src="{{ url_for('static', filename='ecosystem1_filter.js') }}" type="text/javascript"></script>

		<script src="http://d3js.org/d3.v4.min.js" charset="utf-8">
		</script>
		<style>
      		rect.bordered {
				stroke: #E6E6E6;
				stroke-width:2px;
      		}

      		text {
        		font-size: 9pt;
        		font-family: Consolas, courier;
        		fill: #aaa;
      		}
			text.text-highlight {
				fill: #c00;
			}

			rect.cell-hover {
				stroke: #F00;
				stroke-width:0.3px;
			}

		  #tooltip {
			position: absolute;
			width: 200px;
			height: auto;
			padding: 10px;
			background-color: white;
			-webkit-border-radius: 10px;
			-moz-border-radius: 10px;
			border-radius: 10px;
			-webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
			-moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
			box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
			pointer-events: none;
		  }

		  #tooltip.hidden {
			display: none;
		  }

		  #tooltip p {
			margin: 0;
			font-family: sans-serif;
			font-size: 12px;
			line-height: 20px;
		  }

    	</style>

		<div id="chart" class = "scrollable">
		</div>
    	<div id="dataset-picker">
    	</div>

		<script src="{{ url_for('static', filename='ecosystem1_heatmap.js') }}" type="text/javascript">
		</script>
		<div id="tooltip" class="hidden">
			<p><span id="value"></p>
		</div>
		<script>
			var dataset = {{ data | safe }};
			var filter = filter_object(dataset);
			console.log('Data exploration is running.');
			console.log(dataset);

			window.onload = function() {
				myPlot = heatmapChart();
				myPlot.init(dataset['dataExploration']);
				document.querySelector('#BMI').addEventListener('click', function(){
					console.log(filter_wrapper(filter,"Data"))
					myPlot.update(filter_wrapper(filter,"Data"));
				});
				document.querySelector('#NATIONALITY').addEventListener('click', function(){
					console.log(filter_wrapper(filter,"Data"))
					myPlot.update(filter_wrapper(filter,"Data"));
				});
				document.querySelector('#SEX').addEventListener('click', function(){
					console.log(filter_wrapper(filter,"Data"))
					myPlot.update(filter_wrapper(filter,"Data"));
				});
				document.querySelector('#sortby').addEventListener('click', function(){
					console.log(filter_wrapper(filter,"Data"))
					myPlot.update(filter_wrapper(filter,"Data"));
				});
				document.querySelector('#AGE').addEventListener('click', function(){
					console.log(filter_wrapper(filter,"Data"))
					myPlot.update(filter_wrapper(filter,"Data"));
				});
				document.querySelector('#COLUMN').addEventListener('click', function(){
					console.log(filter_wrapper(filter,"Data"))
					myPlot.update(filter_wrapper(filter,"Data"));
				});
				/*document.querySelector('#FROM').addEventListener('input', function(){
					console.log(filter_wrapper(filter,"Data"))
					myPlot.update(filter_wrapper(filter,"Data"));
				});
				document.querySelector('#TO').addEventListener('input', function(){
					console.log(filter_wrapper(filter,"Data"))
					myPlot.update(filter_wrapper(filter,"Data"));
				});
*/
			};

			//EXAMPLE CODE FOR FILTERED VALUES - For testing only
			/* window.onload = function() {
				var filter = filter_object(dataset);

				var filtered_data = filter_wrapper(filter,"Data")

				console.log(filtered_data)
				myPlot = heatmapChart();
				myPlot.init(filtered_data);
			}
			*/


		</script>

{% endblock %}
